<% var records = recordsInfo.records;
var i;
for(i = 0; i < records.length;i++) {
    var diver = records[i].diver;
    var fullName = diver.firstName + ' ' + diver.lastName;
    var userpicSrc;
    if (diver.userpicUrl == null) {
        userpicSrc = '/i/no-userpic-ico.png?v=' + webVersion;
    } else {
        userpicSrc = imagesData.userpicRoot + diver.userpicUrl;
    }
    var starCnt = 0;
    if (diver.diverLevel == 'ONE_STAR') {
        starCnt = 1;
    } else if (diver.diverLevel == 'TWO_STAR') {
        starCnt = 2;
    } else if (diver.diverLevel == 'THREE_STAR') {
        starCnt = 3;
    } else if (diver.diverLevel == 'FOUR_STAR') {
        starCnt = 4;
    }
    // var dob = diver.dob;

    var diveSpot;
    if (records[i].diveSpot) {
        diveSpot = records[i].diveSpot.latinName;
        if (records[i].diveSpot.country) {
            diveSpot += ", " + records[i].diveSpot.country.name;
        }
    } else {
        diveSpot = records[i].name;
    }
    var note = records[i].note;
    var visibleNote;
    var invisibleNote;
    if (note.length > 90) {
        visibleNote = note.substring(0, 90);
        invisibleNote = note.substring(90, note.length);
    } else {
        visibleNote = note;
        invisibleNote = null;
    }
    var isApnea = false;
    var i1;
    for (i1 = 0; i1 < diver.cards.length; i1++) {
        if (diver.cards[i1].cardType == 'APNOEA') {
            isApnea = true;
        }
    }
%>
<div class="panel" id="<%= recordsInfo.containerId %>logbookRecord_<%= records[i].id %>">
    <div id="<%= diver.id %>_foundFriend" class="foundFriendList-elem clearfix">
        <div class="foundFriendList-elem-left">
            <% if(diver.userpicUrl == null){
            %>
                <div class="no-userpic-ico foundFriendList-no-userpic">
                    <img src="/i/no-userpic-ico.png?v=<%= webVersion %>"/>
                </div>
            <% } else { %>
                <div class="userpic-ico foundFriendList-userpic">
                    <div class="rounded foundFriendList-userpic"
                         style='background : url("<%= userpicSrc %>") center no-repeat; background-size: cover'>
                    </div>
                </div>
            <% } %>
        </div>
        <div class="foundFriendList-elem-left">
            <div><span class="basic-text foundFriendList-text"><b><%= fullName %></b></span></div>
            <div>
                <% var j;
                for(j = 0;j < starCnt;j++) {
                %>
                    <img class="foundFriendList-star" src="/i/star.png?v=<%= webVersion %>"/>
                <% } %>
                <% if(isApnea){
                %>
                    <span class="secondary-large-text friendList-text convert-with-labels"><%= labels["cmas.face.logbook.apnea"] %></span>
                    &nbsp;
                <% } %>
                <% if(diver.diverType == 'INSTRUCTOR'){
                %>
                    <span class="secondary-large-text friendList-text convert-with-labels"><%= labels[diver.diverType] %></span>
                    &nbsp;
                <% } %>
                <span class="secondary-large-text foundFriendList-text"><%= labels[diver.diverRegistrationStatus] %></span>
            </div>
<!--            <div class="foundFriendList-elem-left">-->
<!--                <img class="foundFriendList-ico" src="/i/ic_calendar.png?v=<%=/* webVersion */%>"/>-->
<!--                <span class="secondary-large-text foundFriendList-text"><%=/* dob */ %></span>-->
<!--            </div>-->
            <div class="foundFriendList-elem-right">
                <span class="secondary-large-text foundFriendList-text"><%= diver.country.name %></span>
            </div>
        </div>
    </div>
    <div class="clearfix">
        <div class="header3-text"><%= diveSpot %></div>
        <div class="feed-label"><%= records[i].diveDate %></div>
    </div>
    <div>
        <% if(records[i].photoUrl){
            var fullPhotoUrl = imagesData.logbookPicRoot + records[i].photoUrl;
        %>
        <img class="photoFeed" src="<%= fullPhotoUrl %>"/>
        <% } %>
    </div>
    <div class="clearfix">
        <div class="clearfix">
            <div class="feed-spec-label"><%= labels["cmas.face.feed.depth"] %>:</div>
            <div class="feed-spec-text basic-text"><%= records[i].diveSpec.maxDepthMeters %> <%= labels["cmas.face.feed.meters"] %></div>
        </div>
        <div class="clearfix">
            <div class="feed-spec-label"><%= labels["cmas.face.feed.duration"] %>:</div>
            <div class="feed-spec-text basic-text"><%= records[i].diveSpec.durationMinutes %> <%= labels["cmas.face.feed.minutes"] %></div>
        </div>
        <div>
            <% if(records[i].instructor){
                fullName = records[i].instructor.firstName + ' ' + records[i].instructor.lastName;
            %>
            <span class="panelFeed-label"><%= labels["cmas.face.diver.instructor"] %>:</span>
            <a class="panelFeed-href" href="#"
               id="<%= records[i].instructor.id %>_<%= recordsInfo.containerId %>_<%= records[i].id %>_showDiver"><%= fullName %></a>
            <br/>
            <% } %>
            <% if(records[i].buddies.length > 0){
            %>
                <span class="panelFeed-label"><%= labels["cmas.face.feed.buddies.label"] %>:</span>
            <% } %>
            <% var j = 0;
            for(j = 0;j < records[i].buddies.length;j++) {
                fullName = records[i].buddies[j].firstName + ' ' + records[i].buddies[j].lastName;
            %>
            <a class="panelFeed-href" href="#"
               id="<%= records[i].buddies[j].id %>_<%= recordsInfo.containerId %>_<%= records[i].id %>_showDiver"><%= fullName %></a>
            &nbsp;
            <% } %>
        </div>
    </div>

    <div>
        <a href="#" id="<%= recordsInfo.containerId %>SpecOpen_<%= records[i].id %>" class="link-in-text-flow">
            <%= labels["cmas.face.feed.spec"] %>
        </a>
    </div>
    <div id="<%= recordsInfo.containerId %>Spec_<%= records[i].id %>" style="display: none"
         class="feed-additional-section">
        <!-- full spec with tanks-->
        <div>
            <!-- tanks -->
            <% if(records[i].diveSpec.scubaTanks && records[i].diveSpec.scubaTanks.length > 0) { %>
                <div class="clearfix">
                    <div class="feed-tank-label"><%= labels["cmas.face.logbook.tanks.title"] %></div>
                </div>
                <%
                    var k = 0;
                    var index = 1;
                for(k = 0; k < records[i].diveSpec.scubaTanks.length;k++) {
                    var tank = records[i].diveSpec.scubaTanks[k];
                %>
                <div class="feed-tank-elem">
                    <div class="clearfix">
                        <div class="feed-tank-label"><%= labels["cmas.face.logbook.tank.title"] + index %></div>
                        <div class="feed-tank-spec-text">
                            <span class="feed-tank-sub-label"><%= labels["cmas.face.logbook.supplyType"] %>:</span>
                            <span class="basic-text"><%= labels[tank.supplyType] %></span>
                        </div>
                        <div class="feed-tank-spec-text">
                            <span class="feed-tank-sub-label"><%= labels["cmas.face.logbook.tankSize"] %>:</span>
                            <span class="basic-text"><%= tank.size %> <%= labels[tank.volumeMeasureUnit] %></span>
                        </div>
                    </div>
                    <div class="clearfix">
                        <div class="feed-tank-label"><%= labels["cmas.face.logbook.tankPressure"] %>:</div>
                        <div class="feed-tank-spec-text">
                            <span class="feed-tank-sub-label"><%= labels["cmas.face.logbook.tankStartPressure"] %>:</span>
                            <span class="basic-text"><%= tank.startPressure %> <%= labels[tank.pressureMeasureUnit] %></span>
                        </div>
                        <div class="feed-tank-spec-text">
                            <span class="feed-tank-sub-label"><%= labels["cmas.face.logbook.tankEndPressure"] %>:</span>
                            <span class="basic-text"><%= tank.endPressure %> <%= labels[tank.pressureMeasureUnit] %></span>
                        </div>
                    </div>
                    <div class="clearfix">
                        <% if(tank.isAir){ %>
                            <div class="basic-text"> <%= labels["cmas.face.feed.isAir"] %> </div>
                        <% } else if(tank.oxygenPercent || tank.heliumPercent){ %>
                            <div class="feed-tank-label">&nbsp;</div>
                            <div class="feed-tank-spec-text">
                                <span class="feed-tank-sub-label"><%= labels["cmas.face.feed.oxygenPercent"] %>:</span>
                                <span class="basic-text"><%= tank.oxygenPercent %><%= labels["cmas.face.feed.percent"] %></span>
                            </div>
                            <div class="feed-tank-spec-text">
                                <span class="feed-tank-sub-label"><%= labels["cmas.face.feed.heliumPercent"] %>:</span>
                                <span class="basic-text"><%= tank.heliumPercent %><%= labels["cmas.face.feed.percent"] %></span>
                            </div>
                            <% if(tank.isDecoTank){
                            %>
                                <div class="feed-tank-spec-text">
                                    <span class="basic-text"><%= labels["cmas.face.feed.isDecoTank"] %></span>
                                </div>
                            <% } %>
                        <% } %>
                    </div>
                </div>
                <% index++} %>
            <% } else { %>
                <div class="clearfix">
                    <div class="feed-tank-label"><%= labels["cmas.face.logbook.tanks.title"] %>:</div>
                    <div class="feed-spec-text basic-text"><%= labels["cmas.face.feed.isApnea"] %></div>
                </div>
            <% } %>
        </div>
        <div class="clearfix">
            <div class="feed-spec-section">
                <% if(records[i].diveSpec.entryType){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.entryType"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.entryType] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.diveSuit){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.diveSuit"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.diveSuit] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.divePurpose){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.divePurpose"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.divePurpose] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.additionalWeightKg){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.feed.additionalWeightKg"] %>:</div>
                        <div class="feed-spec-text basic-text">
                            <%= records[i].diveSpec.additionalWeightKg %><%= labels["cmas.face.feed.kg"] %>
                        </div>
                    </div>
                <% } %>
            </div>
            <div class="feed-spec-section">
                <% if(records[i].diveSpec.weather){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.weather"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.weather] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.current){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.current"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.current] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.waterType){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.waterType"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.waterType] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.hasSafetyStop){ %>
                    <div class="clearfix">
                        <div class="feed-spec-text basic-text">
                            <%= labels["cmas.face.logbook.hasSafetyStop"] %>
                        </div>
                    </div>
                <% } %>
            </div>
            <div class="feed-spec-section">
                <% if(records[i].diveSpec.airTemp || records[i].diveSpec.waterTemp){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.feed.airAndWaterTemp"] %>:</div>
                        <div class="feed-spec-text basic-text">
                        <span class="feed-margin">
                        <%= labels["cmas.face.logbook.airTemp"] %>
                            : <%= records[i].diveSpec.airTemp %>° <%= labels[records[i].diveSpec.temperatureMeasureUnit] %>
                        </span>
                            <span>
                        <%= labels["cmas.face.logbook.waterTemp"] %>
                            : <%= records[i].diveSpec.waterTemp %>° <%= labels[records[i].diveSpec.temperatureMeasureUnit] %>
                        </span>
                        </div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.surface){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.surface"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.surface] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.underWaterVisibility){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.underWaterVisibility"] %>:</div>
                        <div class="feed-spec-text basic-text"><%= labels[records[i].diveSpec.underWaterVisibility] %></div>
                    </div>
                <% } %>
                <% if(records[i].diveSpec.cnsToxicity){ %>
                    <div class="clearfix">
                        <div class="feed-spec-label"><%= labels["cmas.face.logbook.cnsToxicity"] %>:</div>
                        <div class="feed-spec-text basic-text">
                            <%= records[i].diveSpec.cnsToxicity %>
                        </div>
                    </div>
                <% } %>
            </div>
        </div>
        <% if(records[i].diveSpec.decoStepsComments){ %>
            <div class="feed-note-section clearfix">
                <div class="feed-spec-row-label"><%= labels["cmas.face.logbook.decoStepsComments"] %></div>
                <div class="basic-text">
                    <%= records[i].diveSpec.decoStepsComments %>
                </div>
            </div>
        <% } %>
        <a href="#" id="<%= recordsInfo.containerId %>SpecClose_<%= records[i].id %>" class="link-in-text-flow">
            <%= labels["cmas.face.feed.close"] %>
        </a>
    </div>
    <div>
        <span class="basic-text"><%= visibleNote %></span>
        <% if(invisibleNote){
        %>
            <a href="#" id="<%= recordsInfo.containerId %>more_<%= records[i].id %>" class="link-in-text-flow">
                <%= labels["cmas.face.feed.more"] %>
            </a>
        <% } %>
        <span id="<%= recordsInfo.containerId %>invisibleNote_<%= records[i].id %>" style="display: none">
            <span class="basic-text"><%= invisibleNote %></span><br/>
            <a href="#" id="<%= recordsInfo.containerId %>less_<%= records[i].id %>" class="link-in-text-flow">
                <%= labels["cmas.face.feed.less"] %>
            </a>
        </span>
    </div>
</div>
<% } %>
